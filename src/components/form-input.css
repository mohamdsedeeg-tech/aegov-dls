.aegov-form-control {
  /* --- 1. DEFAULT (PRIMARY) COLOR SCHEME --- */
  --form-label-fg: var(--color-aeblack-800);
  --form-input-bg: var(--color-whitely-50);
  --form-input-ring: var(--color-primary-400);
  --form-input-focus-ring: var(--color-primary-support-600);
  --form-input-text: var(--color-primary-900);
  --form-input-placeholder: var(--color-aeblack-500);
  --form-input-prefix-fg: var(--color-aeblack-500);
  --form-input-focus-prefix-fg: var(--color-primary-900);
  --form-select-arrow: url("data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%237C5E24' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
  --form-dropbox-border: var(--color-primary-400);
  --form-dropbox-label-fg: var(--color-primary-600);
  --form-dropbox-label-fg-hover: var(--color-primary-500);

  /* --- 2. STRUCTURAL STYLES --- */
  & label {
    color: var(--form-label-fg);
    font-size: var(--text-sm);
    @apply mb-1 block font-medium leading-6;
  }

  & .form-control-input {
    background-color: var(--form-input-bg);
    --tw-inset-ring-shadow: inset 0 0 0 2px var(--tw-inset-ring-color, currentcolor);
    box-shadow: 0 0 #0000, var(--tw-inset-ring-shadow), 0 0 #0000, 0 0 #0000, 0 0 #0000;
    --tw-inset-ring-color: var(--form-input-ring);
    @apply relative flex rounded-lg;
    --tw-shadow: var(--shadow-sm);

    &:focus-within {
      --tw-inset-ring-color: var(--form-input-focus-ring);
    }

    & .control-prefix,
    & .control-suffix {
      color: var(--form-input-prefix-fg);
      @apply flex select-none items-center;

      &+input {
        @apply pl-1.5;
      }

      &>svg {
        @apply h-6 w-6 fill-current;
      }
    }

    &:has(:disabled) {
      @apply opacity-40;
    }

    &:has([type="range"]) {
      @apply border-0 focus-visible:ring-2 outline-none;
      box-shadow: none;
      --tw-ring-color: transparent;

      &:focus-visible,
      &:focus-within,
      &:focus {
        --tw-ring-color: var(--form-input-focus-ring);
        outline: none !important;
      }

    }

    & input[type="search"]+.control-suffix {
      &:focus-within {
        color: var(--form-input-focus-ring);
        outline: none;
      }
    }

    & input[type="search"]::-webkit-search-cancel-button {
      cursor: pointer;
    }

    & input[type=file] {
      @apply rounded-lg;
    }

    & .control-prefix {
      @apply ps-4;
    }

    & .control-prefix select {
      @apply ps-0;
    }

    & .control-suffix {
      @apply pe-4;
    }

    & input[type="date"]+.control-suffix,
    & input[type="datetime-local"]+.control-suffix,
    & input[type="month"]+.control-suffix {
      @apply pointer-events-none absolute right-3.5 top-2/4 -translate-y-2/4 appearance-none bg-inherit pe-0;

      & svg {
        --tw-ring-color: var(--form-input-focus-ring);
        @apply focus-within:ring-2 focus-within:ring-inset;
      }
    }

    &:focus-within .control-prefix,
    &:focus-within .control-suffix {
      color: var(--form-input-focus-prefix-fg);
    }
  }

  & select {
    color: var(--form-input-text);
    background-image: var(--form-select-arrow);
    @apply pe-9 ps-4 rtl:bg-[0.5rem] bg-no-repeat;
  }

  & [multiple] {
    @apply bg-none pr-4;
  }

  & textarea {
    @apply h-auto;
  }

  /* --- 3. COLOR VARIANTS --- */
  &.control-secondary {
    --form-input-ring: var(--color-secondary-400);
    --form-input-focus-ring: var(--color-secondary-support-300);
    --form-input-text: var(--color-secondary-900);
    --form-input-focus-prefix-fg: var(--color-secondary-900);
    --form-select-arrow: url("data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%233E4046' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
    --form-dropbox-border: var(--color-secondary-400);
    --form-dropbox-label-fg: var(--color-secondary-600);
    --form-dropbox-label-fg-hover: var(--color-secondary-500);
  }

  &.control-error {
    --form-label-fg: var(--color-aered-600);
    --form-input-bg: var(--color-aered-50);
    --form-input-ring: var(--color-aered-400);
    --form-input-focus-ring: var(--color-aered-600);
    --form-input-text: var(--color-aered-900);
    --form-input-focus-prefix-fg: var(--color-aered-900);
    --form-dropbox-border: var(--color-aered-400);
    --form-dropbox-label-fg: var(--color-aered-600);
    --form-dropbox-label-fg-hover: var(--color-aered-500);

    & .error-message {
      color: var(--color-aered-600);
      @apply text-sm mt-1;
    }
  }

  /* --- 4. STRUCTURAL SUB-COMPONENTS & VARIANTS --- */
  & .form-control-dropbox {

    border-color: var(--form-dropbox-border);
    border-width: 1px;
    border-style: dashed;
    background-color: var(--form-input-bg);
    @apply relative block rounded-lg text-center;
    --tw-shadow: var(--shadow-sm);

    &:focus-within {
      --tw-shadow: var(--shadow-md);
    }

    & svg {
      color: var(--color-slate-300);
      @apply mx-auto h-10 w-10 xl:h-12 xl:w-12;
    }

    & label {
      background-color: var(--form-input-bg);
      color: var(--form-dropbox-label-fg);
      --tw-ring-color: var(--form-input-focus-ring);
      @apply relative inline-block cursor-pointer rounded-lg font-semibold focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2;

      &:hover {
        color: var(--form-dropbox-label-fg-hover);
      }
    }
  }

  &.aegov-file-input-control {
    .file-input-label {
      color: var(--color-whitely-50);
      @apply m-0 !text-base !inline-flex flex-shrink-0 cursor-pointer select-none flex-wrap items-center justify-center text-center no-underline;

      &.file-input-disabled {
        @apply opacity-40;
      }
    }

    input[type="file"] {
      @apply hidden;
    }

    .file-input-summary {
      @apply space-y-4 mt-4;

      .file-input-summary-item {
        color: var(--color-aeblack-500);
        @apply flex flex-wrap gap-3 items-center justify-start text-center font-medium;
      }
    }
  }


}

/* --- 5. SIZE VARIANTS (Structural) --- */
&.control-lg {
  & label {
    @apply text-base;
  }

  & .form-control-input {
    @apply text-lg;

    & input,
    & select,
    & textarea {
      @apply py-4 text-lg;
    }

    & input[type="file"] {
      @apply h-14 file:py-4 text-lg;
    }

    & .control-prefix,
    & .control-suffix {
      &>svg {
        @apply h-7 w-7;
      }
    }
  }
}

&.control-base {
  & label {
    @apply text-sm;
  }

  & .form-control-input {
    @apply text-base;

    & input,
    & select,
    & textarea {
      @apply py-3 leading-6;
      font-size: var(--text-base);
    }

    & input[type="file"] {
      @apply h-12 file:py-3 text-base;
    }

    & .control-prefix,
    & .control-suffix {
      &>svg {
        @apply h-6 w-6;
      }
    }
  }
}

&.control-sm {
  & .form-control-input {
    @apply text-sm;

    & input,
    & select,
    & textarea {
      @apply py-2.5 leading-4;
      font-size: var(--text-sm);
    }

    & input[type="file"] {
      @apply h-10 file:py-2.5 leading-4;
      font-size: var(--text-sm);
    }

    & .control-prefix,
    & .control-suffix {
      &>svg {
        @apply h-5 w-5;
      }
    }
  }
}